# 学習ノート: Houdiniで複雑なパターンをカスタムUVsで作成する

## 📌 概要
このチュートリアルでは、**UV空間の操作**と**複数の系統の統合**を通じて、Houdiniで極めて複雑で高度なテクスチャを作成する手法を解説しています。基本的なタイル化から、ジオメトリのラスタライズ、マスク生成、ブレンドに至るまでの一連の技法が含まれます。

---

## 🎯 重要概念

### 1. **UV空間と座標系**

#### 基本的なUV空間
- **デフォルトUV座標**: (0,0) が左下、(1,1) が右上
- **Houdini Copernicusの場合**: UVs は **-1 から 1** の範囲で動作
- これにより、0〜1 の範囲から -1〜1 の範囲への**Remap処理**が必要になる

#### 例: 基本的なUVサンプリング
```
UV Map → UV Sample → タイルパターンにプラグイン
= デフォルト座標のままでは何も変わらない
```

#### 応用方法
- **歪み効果**: Distort ノードで UV 空間を直接操作
- **Fractal Noise**: UV 方向に Noise を適用し、スケール値で歪み量を制御

---

### 2. **カスタムUVsの生成**

#### Rampを使ったUV座標の手動作成
**目的**: タイル生成時に UV 空間をプログラマティックに定義

**構築方法**:
1. **Ramp Mono** 2つを用意
   - 水平ラップ: 左0から右1（X座標相当）
   - 垂直ラップ: 下0から上1（Y座標相当）

2. **Channel Join** でX、Yを結合
   - 第1入力: 水平ラップ（X）
   - 第2入力: 垂直ラップ（Y）

3. **UV Transform** で座標を-1〜1に変換
   - Uniform Scale を2に設定

#### 例: 放射状タイルパターン
```
- Radial Ramp + Concentric Ramp → 同心円状タイル
- Multiply Constant で均一性を調整（奇数値推奨: 3, 5）
- 中心座標をラップ間で同期させる
```

**応用**: 
- ハニカムパターン（Herringbone）
- 風車パターン（Windmill）
- ホップスコッチ（Hopscotch）

---

### 3. **マスク生成と活用**

#### 3つの基本マスク
1. **外側マスク (Outer)**: ラップの外縁
2. **内側マスク (Inner)**: ラップの中心
3. **リングマスク (Ring)**: 勾配による中間領域

#### マスク作成手順
```
Remap → 低端を上へ → コンプリメント → 外側マスク
（重複後、両端をドラッグ） → 中心マスク
（重複後、開始地点に2ポイント追加） → リングマスク
```

#### マスク処理ノード化
- **Network Box** でマスク系統を統合
- **Output Node** で各マスクを個別出力
- 後続処理で **Blend** や **Multiply** で活用

#### 応用例
- **Dilate/Erode**: マスク範囲を拡張・縮小してリング効果追加
- **Difference**: ディレート後のマスクと元マスクの差分で境界線抽出

---

### 4. **ジオメトリのラスタライズと統合**

#### ラスタライズの必的なステップ
1. **Rasterized Geo Quick Setup**: 必要な入力設定
2. **Rasterize**: ジオメトリを2D画像に変換
3. **Equalize**: 値の範囲を正規化（重要）
4. **Match Size**: フレーミングを修正（-1〜1 から 0〜1 へ）

#### 深度情報の取得と反転
```
Depth from I → Equalize → Remap（ラップ反転）
→ 背景を黒、前景を白に
```

#### 例: バッジ作成
```
Rasterized Toy + SDF Circle (Onion Skin) → Maximum 合成
= 装飾的なバッジをタイル中央に配置
```

---

### 5. **Stamp Points による複数配置**

#### Stamping のメカニズム
- **Grid**: 配置ポイントを格子状に生成
- **Stamp Points**: 指定ジオメトリを各ポイントに複製

#### マスクとの連動
```
タイル Stamp + マスク Stamp + エンブレム Stamp
+ 外側マスク Stamp
→ 統合 Network で一元管理
```

#### 応用例
- 複数パターンの層状化（Windmill + Hopscotch）
- **Dilate/Erode** でレイヤー間に縁取り追加

---

### 6. **バリエーションと質感の追加**

#### Connectivity による個別ID割り当て
```
Segment by Connectivity → 各タイルに一意なID付与
→ UV Map by ID → 0〜1 座標を各タイルに
```

#### UV Transform による回転バリエーション
```
UV Transform + ID をSeed → 各タイルで異なる回転
→ Ramp Mono でグラデーション → 高さに乗算
```

#### 結果
- **高さ**: タイルごとに微細な変動 → 光の捉え方に奥行き
- **ラフネス**: 同様に変動させ素材感を強調

#### カラーリングとメタリック効果
```
高さ → Ambient Occlusion → Ramp RGB でカラーマップ
→ 緑（低端）で銀色の経年変化 → Metalness を1に設定
```

---

## 💡 実践的な応用方法

### 1. **基本パターンから複雑性へ**
   - シンプルなタイル（正方形）から開始
   - マスクで異なるパターンをブレンド
   - ID ベースのバリエーション追加

### 2. **レイヤー構造の活用**
   ```
   Layer 1: 基本タイル（背景）
   Layer 2: ブレンドされたパターン（エンブレム周辺）
   Layer 3: インターレイヤー装飾（ブラー + Remap）
   ```

### 3. **マスク駆動の効率的な調整**
   - 1つのマスクで複数レイヤーを制御
   - **Invert** で逆効果を生成
   - **HSV Adjust** で色・明度を個別制御

### 4. **レンダリング結果の最適化**
   - **Dicing** を有効にして計算負荷軽減
   - **Height Scale** を調整して凹凸感を強調
   - **Output Range** を増加させて目立たせ（3〜4推奨）

---

## 🔧 技法チェックリスト

- [ ] **UV空間の基本理解**: デフォルト座標（0〜1）と Houdini座標（-1〜1）の違い
- [ ] **カスタムUV生成**: Ramp + Channel Join + UV Transform の組み立て
- [ ] **3層マスク作成**: Outer、Inner、Ring マスクの生成と活用
- [ ] **ジオメトリ統合**: ラスタライズと Match Size による正確なフレーミング
- [ ] **Stamping と複製**: 複数パターンの層状化
- [ ] **個別バリエーション**: Connectivity + ID による自動変動
- [ ] **最終調整**: 色、メタリック、粗さの微調整

---

## ✨ 学習のポイント

1. **UV空間操作は全ての基礎**: 歪み、スケール、回転すべてUVで制御可能
2. **マスクの事前準備が重要**: 複雑な合成も「マスク駆動」で管理しやすくなる
3. **Network化で再利用性向上**: 同じ仕組みを複数回使用すれば、バリエーション拡大は容易
4. **IDベースの自動化**: 手作業でなく、パラメータ変更のみで大幅な変更可能
5. **段階的な質感追加**: 高さ → ラフネス → 色 の順序で肉付けすると効率的

---

## 📚 参考事項

- **Houdini Copernicus** を使用（新しいバージョンでは UI や操作が異なる可能性）
- ファイルのダウンロード可能（イントロ画像用のサンプルファイル）
- **SideFX公式サイト** または **Houdini Academy Discord** でのサポート利用推奨
- 複雑性の追加は「既存マスクの活用」と「新規マスクの生成」の組み合わせで実現可能

---

**作成者**: Houdini Academy チュートリアル  
**動画**: How to Create Complex Patterns with Custom UVs (986452691)  
**概要作成**: 2026年1月9日
